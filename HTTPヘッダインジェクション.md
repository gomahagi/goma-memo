# 脆弱性の概要
ユーザ⼊⼒値などのクライアントから送信される値を適切に処理することなく、HTTPレスポンスヘッダに含めてしまうことにより発⽣する脆弱性および攻撃⼿法
この脆弱性を使⽤して、攻撃者はHTTPレスポンスヘッダに任意のヘッダフィールドを追加したり、レスポンスボディに任意のコンテンツを追加できるため、さまざまな攻撃の⽷⼝となる危険性がある。

### 影響
 - 正規ユーザのアカウントの乗っ取りやなりすまし
 - サイト利⽤者に表⽰されるコンテンツの改ざん
 - 外部サイトへの意図しないリダイレクトなど。

### 方法
- セッションの固定化(セッションフィクセーション)  
  1. 攻撃者はHTTPヘッダインジェクションを⽤いて、Set-Cookieヘッダに任意のセッションIDを指定するように細⼯したURLを何らかの⽅法で正規ユーザにクリックさせる
  2. 正規ユーザは細⼯されたURLから脆弱なサイトにアクセスする
  3. 攻撃者は指定したセッションIDを⽤いて、正規ユーザとしてサイトにアクセスする

- レスポンスボディを任意のコンテンツに改ざんする
  1. 攻撃者は、細⼯されたURLを正規ユーザにクリックさせる
  2. 正規ユーザは、細⼯されたURLから脆弱なWebサイトにアクセスする
  3. 正規ユーザは、攻撃者の指定したコンテンツを含んだレスポンスを受け取る

### 対策
- ユーザ⼊⼒値をレスポンスヘッダに含めない。ただし、実装要件としてユーザ⼊⼒値をレスポンスヘッダに含める必要がある場合は、改⾏⽂字を出⼒しないようにする。
- 

# 参考

https://www.ubsecure.jp/blog/http-header-injection
