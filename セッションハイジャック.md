# 脆弱性の概要
セッションIDを知る手段。
- 他の脆弱性や設定不備を利用してセッションIDを奪う  
  - クロスサイトスクリプティング(XSS)
- セッションIDを推測する
  - burpで複雑性の確認可能
- 通信を盗聴し、セッションIDを盗む
  - クライアントとサーバ間で通信が暗号化されていない時、パケットキャプチャで通信を盗聴し、セッションIDを奪う
  - URLにセッションIDがあった場合、次にアクセスしたサイトへrefererとかで漏洩する場合がある
- セッションを固定化する(セッション・フィクセーション)
  - 攻撃者の用意したセッションIDを正規利用者に強制使用させる
  - 利用者がログインなどでセッションを確立した後、攻撃者が利用者と同じセッションIDを使用することで利用者になりすまして不正な操作を行う
  - セッションの固定化が可能な場合はセッションハイジャックができる可能性がある
  - 代表的な攻撃手法
  - 攻撃者が利用者にセッションIDを強制する方法はURLにセッションIDを埋め込む方法、スクリプトを使用し、セッションIDを強制する方法(クロスサイトスクリプティング脆弱性)、レスポンスヘッダを追加してCookieを強制する方法(HTTPヘッダインジェクション脆弱性)。レスポンスヘッダを追加してCookieを強制する方法は攻撃者がSet-Cookieヘッダを挿入することで利用者にCookieを強制し、利用者は攻撃者によって任意のセッションIDを強制される。

### 対策
- 1.セッションIDを推測困難なものにする
- 2.セッションIDをURLパラメータに格納しない
  - セッションIDがURLパラメータに格納されている場合、ブラウザのReferer機能などによって攻撃者にセッションを知られてしまう可能性がある。セッションIDをパラメータに格納する場合は、URLパラメータではなく、CookieやPOSTメソッドのhiddenパラメータに格納する。
- 3.HTTPS通信で利用するCookieにはsecure属性を加える
  - secure属性を設定してHTTPS通信でのみCookieを使用するようにする。
- 4.ログイン成功後に新しくセッションを開始する
  - ログイン前のセッションIDとログイン後のセッションIDを別にする
- ログイン成功後に、既存のセッション ID とは別に秘密情報を発行し、ページの遷移ごとにその値を確認する
  - セッションIDとは別に秘密情報を作成し、セッションIDと秘密情報の値が一致することで正規の利用者である確認する。 この対策を行う場合はすべてのページでセッションIDと秘密情報の値が一致することを確認する必要がある。 対策4.を実施している場合は、本対策は不要。 


```py
print("test")
```
